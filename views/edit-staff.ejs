<main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">

    <!-- Title Page Staff -->
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
      <h1 class="h2">EDIT STAFF</h1>
    </div>
  
    <!-- Title Edit Staff -->
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center">
        <h4>Form Edit Staff</h4>
        <div>
          <a href="/staff/edit/<%= staff.name %>" type="button" class="btn btn-sm btn-outline-primary text-center">Reset<i class="bi bi-arrow-right-square ms-2"></i></a>
          <a href="/staff" type="button" class="btn btn-sm btn-outline-primary text-center">Back<i class="bi bi-arrow-right-square ms-2"></i></a>
        </div>
    </div>
  
    <!-- Alert Error Form -->
    <% if (typeof errors != 'undefined') { %>
      <div class="alert alert-danger fw-bold" role="alert">
        <ul>
          <% errors.forEach(error => { %>
            <li><%= error.msg %> </li>
          <% }) %>
        </ul>
      </div>
    <% } %>
  
    <!-- Form add staff -->
    <form method="POST" action="/staff?_method=PUT" enctype="multipart/form-data">
      <input type="hidden" name="_id" value="<%= staff._id %>">
      <input type="hidden" name="oldName" value="<%= staff.oldName || staff.name %>">
  
  
      <div class="row">
        
        <!-- Left Form -->
        <div class="col-6">
          <!-- Name -->
          <div class="mb-3">
            <label for="name" class="form-label">Name</label>
            <input type="text" class="form-control" id="name" name="name" required value="<%= staff.name %>">
          </div>

          <!-- Email -->
          <div class="mb-3">
            <label for="email" class="form-label">Email</label>
            <input type="email" class="form-control" id="email" name="email" required value="<%= staff.email %>">
          </div>

          <!-- Status -->
          <label for="status" class="form-label">Status</label>       
          <select class="form-select mb-3" aria-label="Default select example" name="status">
            <option value="Reguler Employee" <%= staff.status === "Reguler Employee" ? "selected" : "" %>>Reguler Employee</option>
            <option value="Temporary Worker" <%= staff.status === "Temporary Worker" ? "selected" : "" %>>Temporary Worker</option>
            <option value="Parttime Worker" <%= staff.status === "Parttime Worker" ? "selected" : "" %>>Parttime Worker</option>
          </select>
  
          <!-- No ID -->
          <div class="mb-3">
            <label for="noID" class="form-label">No ID</label>
            <input type="text" class="form-control" id="noID" name="noID" required value="<%= staff.noID %>">
          </div>
  
          <!-- Department -->
          <label for="department" class="form-label">Department</label>
          <select class="form-select mb-3" aria-label="Default select example" name="department">
            <option value="Mechanical Engineering" <%= staff.department === "Mechanical Engineering" ? "selected" : "" %>>Mechanical Engieering</option>
            <option value="Electrical Engineering" <%= staff.department === "Electrical Engineering" ? "selected" : "" %>>Electrical Engineering</option>
            <option value="Industrial Engineering" <%= staff.department === "Industrial Engineering" ? "selected" : "" %>>Industrial Engineering</option>
            <option value="Civil Engineering" <%= staff.department === "Civil Engineering" ? "selected" : "" %> >Civil Engineering</option>
            <option value="Informatic Engineering" <%= staff.department === "Informatic Engineering" ? "selected" : "" %>>Informatic Engineering</option>
          </select>
        </div>
  
        <!-- Right Form -->
        <div class="col-6">
          <!-- Birth -->
          <div class="mb-3">
            <label for="birth" class="form-label">Birth</label>
            <input type="text" class="form-control" id="birth" name="birth" required value="<%= staff.birth %>" required>
          </div>
  
          <!-- Genre -->
          <label for="genre" class="form-label">Genre</label>       
          <select class="form-select mb-3" aria-label="Default select example" name="genre">
            <option value="Man" <%= staff.genre === "Man" ? "selected" : "" %>>Man</option>
            <option value="Female" <%= staff.genre === "Female" ? "selected" : "" %>>Female</option>
          </select>
  
          <!-- No Phone -->
          <div class="mb-3">
            <label for="noPhone" class="form-label">No Phone</label>
            <input type="noPhone" class="form-control" id="noPhone" name="noPhone" required value="<%= staff.noPhone %>">
          </div>
  
          <!-- Address -->
          <div class="mb-3">
            <label for="address" class="form-label">Address</label>
            <input type="text" class="form-control" id="address" name="address" required value="<%= staff.address %>">
          </div>

          <!-- Start Working -->
          <div class="mb-3">
            <label for="start" class="form-label">Start Working</label>
            <input type="text" class="form-control" id="start" name="start" value="<%= staff.start %>">
          </div>
  
          <!-- Image -->
          <label for="image" class="form-label">Photo</label> 
  
          <% if (staff.image) { %>
            <img src="/img/<%= staff.image %>" alt="<%= staff.name %>" width="100px" class="img-fluid img-preview d-block">
          <% } else { %>
            <img class="img-fluid img-preview" width="100px" >
          <% } %>
          <div class="input-group mb-3">
            <input type="hidden" name="oldImage" value="<%= staff.oldImage || staff.image %>" >
            <input type="file" class="form-control" id="image" name="image" onchange="previewImage()">
          </div>
        </div>
  
        <!-- Button Submit -->
        <button type="submit" class="btn btn-primary">Update Data</button>
  
      </div>
    </form>
  </main>
  <script>
    function previewImage() {
      const image = document.querySelector('#image');
      const imgPreview = document.querySelector('.img-preview');
  
      imgPreview.style.display = 'block';
  
      const oFReader = new FileReader();
      oFReader.readAsDataURL(image.files[0]);
  
      oFReader.onload = function(oFREvent) {
        imgPreview.src = oFREvent.target.result;
      }
    }
  </script>
  
  